FROM node:14.17.0-alpine3.13

ARG WORKDIR=/front/
ARG API_URL
ARG HOST
ARG FRONT_PORT
ARG FIREBASE_API_KEY
ARG FIREBASE_AUTH_DOMAIN
ARG FIREBASE_PROJECT_ID
ARG FIREBASE_STORAGE_BUCKET
ARG FIREBASE_SENDER_ID
ARG FIREBASE_APP_ID
ARG FIREBASE_MEASUREMENT_ID
ARG GMAP_API_KEY

ENV LANG                              C.UTF-8
ENV TZ                                Asia/Tokyo
ENV REACT_APP_API_URL                 ${API_URL}
ENV REACT_APP_HOST                    ${HOST}
ENV PORT                              ${FRONT_PORT}
ENV REACT_APP_FIREBASE_API_KEY        ${FIREBASE_API_KEY}
ENV REACT_APP_FIREBASE_AUTH_DOMAIN    ${FIREBASE_AUTH_DOMAIN}
ENV REACT_APP_FIREBASE_PROJECT_ID     ${FIREBASE_PROJECT_ID}
ENV REACT_APP_FIREBASE_STORAGE_BUCKET ${FIREBASE_STORAGE_BUCKET}
ENV REACT_APP_FIREBASE_SENDER_ID      ${FIREBASE_SENDER_ID}
ENV REACT_APP_FIREBASE_APP_ID         ${FIREBASE_APP_ID}
ENV REACT_APP_FIREBASE_MEASUREMENT_ID ${FIREBASE_MEASUREMENT_ID}
ENV REACT_APP_GMAP_API_KEY            ${GMAP_API_KEY}

WORKDIR ${WORKDIR}

COPY package.json ${WORKDIR}
COPY yarn.lock ${WORKDIR}

RUN yarn install

COPY . ${WORKDIR}

EXPOSE ${PORT}
